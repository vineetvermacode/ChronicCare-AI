<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>ChronicCare-AI</title>
    <link href="{{ url_for('static', filename='logo.png') }}" rel="icon" type="image/png">

    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
          rel="stylesheet">

    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" rel="stylesheet">
</head>
<style>
        body {
            background: linear-gradient(135deg, #1f4037, #99f2c8);
            color: black;
            font-family: "Fira Sans", sans-serif;
        }
        .logo {
            width: 50px;
            height: 50px;
            color: black;
            margin-top: 0;
            margin-left: 2px;
        }

        .myimg {
            width: 50px;
            height: 50px;
            border: 2px solid black;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }
        .myimg:hover {
            transform: scale(1.1);
        }

        .animated-navbar {
    animation: slideInDown 0.8s ease-in-out;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    border-bottom: 2px solid #1db954;
}
@keyframes slideInDown {
    from {
        opacity: 0;
        transform: translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
.navbar-nav .nav-link {
    position: relative;
    transition: color 0.3s ease-in-out;
}

.navbar-nav .nav-link:hover {
    color: #1db954 !important;
}

.hover-underline::after {
    content: '';
    position: absolute;
    width: 0%;
    height: 2px;
    bottom: -4px;
    left: 0;
    background-color: #1db954;
    transition: width 0.3s ease-in-out;
}

.hover-underline:hover::after {
    width: 100%;
}

        .form-container {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 40px;
            animation: fadeInUp 1s;
        }
        .btn-custom {
            border-radius: 25px;
            transition: all 0.3s ease-in-out;
        }
        .btn-custom:hover {
            transform: scale(1.05);
            opacity: 0.9;
        }
        .result-container button {
            animation: pulse 2s infinite;
        }


        @keyframes pulse {
        0% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.05);
        }
        100% {
            transform: scale(1);
        }
        }
        .result-container {
        animation: fadeIn 1.2s ease-in-out;
    }
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

        @media (max-width: 768px) {
            .form-container {
                padding: 20px;
            }
            .result-container {
                text-align: center;
            }
            .result-container button {
                width: 100% !important;
                margin: 10px 0 !important;
            }
            h1 {
                font-size: 1.8rem;
            }
        }
        @media (max-width: 480px) {
            .navbar-brand {
                font-size: 1.2rem;
            }
            .form-control, .btn {
                font-size: 0.9rem;
            }
        }
        .navbar-nav .nav-link.active {
    color: #1db954 !important; /* Bright green */
    font-weight: bold;
    position: relative;
}
.navbar-nav .nav-link.active::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 3px;
    bottom: -4px;
    left: 0;
    background-color: #1db954;
    border-radius: 2px;
    }


  .suggestion-box {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      color: black;
      background-color: white;
      border: 1px solid black;
      z-index: 999;
      max-height: 200px;
      overflow-y: auto;
  }

  .suggestion-box div {
      padding: 8px;
      cursor: pointer;
  }

  .suggestion-box div:hover {
      background-color: #f1f1f1;
  }









</style>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow animated-navbar">
    <div class="container-fluid">
        <!-- Logo at the top-left corner -->
        <div class="logo">
            <img alt="Logo" class="myimg" src="{{ url_for('static', filename='logo.png') }}">
        </div>


        <a class="navbar-brand animate__animated animate__fadeIn" href="/">Chronic Care AI</a>
        <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
                class="navbar-toggler"
                data-bs-target="#navbarSupportedContent" data-bs-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse animated-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a aria-current="page"
                       class="nav-link hover-underline {% if request.path == '/' %}active{% endif %}" href="/">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link hover-underline {% if request.path == '/about' %}active{% endif %}"
                       href="/about">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link hover-underline {% if request.path == '/contact' %}active{% endif %}"
                       href="/contact">Contact</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link hover-underline {% if request.path == '/developer' %}active{% endif %}"
                       href="/developer">Developer</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link hover-underline {% if request.path == '/blog' %}active{% endif %}" href="/blog">Blog</a>
                </li>
            </ul>
            <form class="d-flex position-relative" id="navbar-search-form">
                <input autocomplete="off" class="form-control me-2" id="search-box" name="query"
                       placeholder="Search disease..." type="search">
                <div class="suggestion-box" id="suggestions"></div>
                <button class="btn btn-outline-success" type="submit">Search</button>
            </form>


        </div>
    </div>
</nav>

<!-- Modal -->
<div aria-hidden="true" aria-labelledby="resultModalLabel" class="modal fade" id="resultModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="resultModalLabel">Disease Info</h5>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body" id="modal-body-content">
                <!-- Dynamic content will come here -->
            </div>
        </div>
    </div>
</div>


<!-- main form of page -->
<h1 class="mt-2 my-2 text-center text-green animate__animated animate__fadeInDown" style="color:white;">ChronicCare
    AI</h1>
<div class="container my-3 form-container">
    <form action="/predict" method="post">
        <div class="form-group">
            <label for="symptoms">Select Symptoms:</label>
            <input class="form-control" id="symptoms" name="symptoms"
                   placeholder="type systems such as itching, sleeping, aching etc"
                   type="text"
                   value="{{ request.form.get('symptoms', '') }}">>

        </div>

        <button class="btn btn-info btn-custom" id="startSpeechRecognition" type="button">
            🎙 Start Speech Recognition
        </button>

        <!-- Display the transcribed text here -->
        <div id="transcription" name="mysysms"></div>

        {% if message %}
        <p>{{ message }}</p>
        {% endif %}

        <button class="btn btn-danger btn-lg btn-custom mt-3 w-100" type="submit">
            Predict
        </button>
    </form>
</div>

{% if predicted_disease %}

<!-- Results -->
<h1 class="text-center my-4 mt-4 animate__animated animate__fadeInUp" style="color:white;">Our AI System Results</h1>
<div class="container animate__animated animate__zoomIn animate__delay-1s" style="padding-bottom: 50px;">

    <div class="result-container d-flex flex-wrap justify-content-center gap-1">
        <!-- Buttons to toggle display -->
        <button class="toggle-button btn-warning fw-bold animate__animated animate__pulse animate__infinite"
                data-bs-target="#diseaseModal" data-bs-toggle="modal"
                style="padding:4px;  margin: 5px 40px 5px 0; font-size:20px;font-weight:bold; width:140px; border-radius:5px; background:#F39334;color:black;">
            Disease
        </button>
        <button class="toggle-button btn-primary fw-bold animate__animated animate__pulse animate__infinite animate__delay-1s"
                data-bs-target="#descriptionModal" data-bs-toggle="modal"
                style="padding:4px; margin: 5px 40px 5px 0; font-size:20px;font-weight:bold; width:140px; border-radius:5px; background:#268AF3 ;color:black;">
            Description
        </button>
        <button class="toggle-button btn-pink fw-bold animate__animated animate__pulse animate__infinite animate__delay-2s"
                data-bs-target="#precautionModal" data-bs-toggle="modal"
                style="padding:4px; margin: 5px 40px 5px 0; font-size:20px;font-weight:bold; width:140px; border-radius:5px; background:#F371F9 ;color:black;">
            Precaution
        </button>
        <button class="toggle-button btn-danger fw-bold animate__animated animate__pulse animate__infinite animate__delay-3s"
                data-bs-target="#medicationsModal" data-bs-toggle="modal"
                style="padding:4px; margin: 5px 40px 5px 0; font-size:20px;font-weight:bold; width:140px;border-radius:5px; background:#F8576F ;color:black;">
            Medications
        </button>
        <button class="toggle-button btn-success fw-bold animate__animated animate__pulse animate__infinite animate__delay-4s"
                data-bs-target="#workoutsModal" data-bs-toggle="modal"
                style="padding:4px; margin: 5px 40px 5px 0; font-size:20px;font-weight:bold; width:140px; border-radius:5px; background:#99F741 ;color:black;">
            Workouts
        </button>
        <button class="toggle-button btn-warning fw-bold animate__animated animate__pulse animate__infinite animate__delay-5s"
                data-bs-target="#dietsModal" data-bs-toggle="modal"
                style="padding:4px; margin: 5px 40px 5px 0; font-size:20px;font-weight:bold; width:140px; border-radius:5px; background:#E5E23D;color:black;">
            Diets
        </button>
    </div>
</div>

{% endif %}

<!-- Disease Modal -->
<div aria-hidden="true" aria-labelledby="diseaseModalLabel" class="modal fade" id="diseaseModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #020606; color:white;">
                <!-- Set header background color inline -->
                <h5 class="modal-title" id="diseaseModalLabel">Predicted Disease</h5>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body" style="background-color: #modal-body-color;">
                <!-- Set modal body background color inline -->
                <p>{{ predicted_disease }}</p>
            </div>
        </div>
    </div>
</div>


<!-- Description Modal -->
<div aria-hidden="true" aria-labelledby="descriptionModalLabel" class="modal fade" id="descriptionModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #020606; color:white;">
                <h5 class="modal-title" id="descriptionModalLabel">Description</h5>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body">
                <p>{{ dis_des }}</p>
            </div>
        </div>
    </div>
</div>

<!-- Precaution Modal -->
<div aria-hidden="true" aria-labelledby="precautionModalLabel" class="modal fade" id="precautionModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #020606; color:white;">
                <h5 class="modal-title" id="precautionModalLabel">Precaution</h5>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body">
                <ul>
                    {% for i in my_precautions %}
                    <li>{{ i }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>


<!-- Medications Modal -->
<div aria-hidden="true" aria-labelledby="medicationsModalLabel" class="modal fade" id="medicationsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #020606; color:white;">
                <h5 class="modal-title" id="medicationsModalLabel">Medications</h5>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body">
                <ul>
                    {% for mlist in medications %}
                    {% for m in mlist %}
                    <li>{{ m }}</li>
                    {% endfor %}
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Workouts Modal -->
<div aria-hidden="true" aria-labelledby="workoutsModalLabel" class="modal fade" id="workoutsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #020606; color:white;">
                <h5 class="modal-title" id="workoutsModalLabel">Workouts</h5>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body">
                <ul>
                    {% for i in workout %}
                    <li>{{ i }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Diets Modal -->
<div aria-hidden="true" aria-labelledby="dietsModalLabel" class="modal fade" id="dietsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #020606; color:white;">
                <h5 class="modal-title" id="dietsModalLabel">Diets</h5>
                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
            </div>
            <div class="modal-body">
                <ul>
                    {% for dlist in my_diet %}
                    {% for d in dlist %}
                    <li>{{ d }}</li>
                    {% endfor %}
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>


<section style="padding: 80px">
    <h2 style="text-align:center; font-size: 40px; font-weight: bold; color: white; margin-bottom: 30px;">Key
        Features</h2>
    <div style="display: flex; justify-content: space-around; flex-wrap: wrap;">

        <div style="width: 300px; margin: 10px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
            <img src="{{ url_for('static', filename='assets/condition.gif') }}"
                 style="width: 100%; margin-bottom:20px; height: 180px; object-fit: cover; border-radius: 8px;">
            <h3>Condition Prediction</h3>
            <p>Predicts chronic conditions using AI models based on user symptoms and data.</p>
        </div>

        <div style="width: 300px; margin: 10px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
            <img src="{{ url_for('static', filename='assets/personalized.gif') }}"
                 style="width: 100%; margin-bottom:20px; height: 180px; object-fit: cover; border-radius: 8px;">
            <h3>Symptom-Based Query System</h3>
            <p>Takes user symptoms as input via text, and maps them to possible conditions and medicine using your AI
                logic.</p>
        </div>

        <div style="width: 300px; margin: 10px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
            <img src="{{ url_for('static', filename='assets/medicine.gif') }}"
                 style="width: 100%; margin-bottom:20px; height: 180px; object-fit: cover; border-radius: 8px;">
            <h3>Medicine Recommendation System</h3>
            <p>Recommends appropriate medicine based on diagnosed condition using AI/mapped datasets.</p>
        </div>

    </div>
</section>

<!-- speech recognition script-->
<script>
const startSpeechRecognitionButton = document.getElementById('startSpeechRecognition');
const transcriptionDiv = document.getElementById('transcription');
const symptomsInput = document.getElementById('symptoms');

let finalTranscript = '';
let lastWordTime = Date.now();

startSpeechRecognitionButton.addEventListener('click', startSpeechRecognition);

function startSpeechRecognition() {
    const recognition = new webkitSpeechRecognition();
    recognition.lang = 'en-US';
    recognition.interimResults = true;
    recognition.continuous = true;

    finalTranscript = '';
    let timeout = null;

    recognition.onresult = function(event) {
        let currentTranscript = '';
        let currentTime = Date.now();

        for (let i = event.resultIndex; i < event.results.length; ++i) {
            const result = event.results[i];
            if (result.isFinal) {
                let spoken = result[0].transcript.trim().toLowerCase();
                let words = spoken.split(/\s+/);

                words.forEach((word, index) => {
                    const timeDiff = Date.now() - lastWordTime;

                    if (index === 0 && finalTranscript !== '') {
                        // Add separator based on pause
                        finalTranscript += timeDiff < 700 ? '_' : ',';
                    } else if (index !== 0) {
                        finalTranscript += '_';
                    }

                    finalTranscript += word;
                    lastWordTime = Date.now();
                });

                symptomsInput.value = finalTranscript;
                transcriptionDiv.innerText = finalTranscript;
            }
        }

        // Reset 3-second silence timeout
        if (timeout) clearTimeout(timeout);
        timeout = setTimeout(() => {
            recognition.stop();
            console.log("⏱️ Auto-stopped after 3s silence");
        }, 3000);
    };

    recognition.onend = function () {
        console.log('🎤 Speech recognition ended.');
    };

    recognition.start();
}






</script>

<!--search  bar-->
<script>
    document.getElementById("navbar-search-form").addEventListener("submit", function (e) {
  e.preventDefault();
  const query = document.getElementById("search-box").value;

  fetch(`/api/search?query=${query}`)
    .then(res => res.json())
    .then(data => {
      if (data.success) {
        const html = `
          <h5><strong>${data.disease}</strong></h5>
          <p><strong>Description:</strong> ${data.desc}</p>
          <p><strong>Precautions:</strong></p>
          <ul>${data.precautions.map(p => `<li>${p}</li>`).join('')}</ul>
          <p><strong>Medications:</strong></p>
          <ul>${data.medications.map(m => `<li>${m}</li>`).join('')}</ul>
          <p><strong>Diet:</strong></p>
          <ul>${data.diet.map(d => `<li>${d}</li>`).join('')}</ul>
          <p><strong>Workout:</strong></p>
          <ul>${data.workout.map(w => `<li>${w}</li>`).join('')}</ul>
        `;
        document.getElementById("modal-body-content").innerHTML = html;

        window.scrollTo({ top: 0, behavior: 'smooth' }); // Optional
        new bootstrap.Modal(document.getElementById('resultModal')).show();
      } else {
        alert(data.error);
      }
    });
});






</script>



<script>
  const searchBox = document.getElementById("search-box");
  const suggestionBox = document.getElementById("suggestions");

  searchBox.addEventListener("input", async () => {
    const query = searchBox.value.trim();
    if (!query) {
      suggestionBox.innerHTML = "";
      return;
    }

    const response = await fetch(`/autocomplete?query=${query}`);
    const suggestions = await response.json();

    suggestionBox.innerHTML = "";
    suggestions.forEach(item => {
      const div = document.createElement("div");
      div.textContent = item;
      div.onclick = () => {
        searchBox.value = item;
        suggestionBox.innerHTML = "";
      };
      suggestionBox.appendChild(div);
    });
  });

  document.addEventListener("click", (e) => {
    if (!searchBox.contains(e.target)) {
      suggestionBox.innerHTML = "";
    }
  });



</script>

<script crossorigin="anonymous"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
